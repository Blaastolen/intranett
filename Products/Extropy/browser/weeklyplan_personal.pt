<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      i18n:domain="extropy"
      metal:use-macro="here/main_template/macros/master">
  <head>
      <metal:style fill-slot="css_slot">
            <style type="text/css">
                table .planning { width: 100%;}

                
                table .planning td { padding: 1em;
                                     border-top-width : 1px;
                                     }
            
                .plan-day {     width : 18%;
                                height : 2em;
                                padding : 0.5em 1em;
                            
                    }
            </style>
      </metal:style>
      <metal:block fill-slot="top_slot"
                   tal:define="dummy python:request.set('disable_border',1)" /> 
  </head>
<body>
<div metal:fill-slot="main">

<h1>Weekly planning for 
  <span tal:define="author python:mtool.getMemberInfo(view.user)"
        tal:replace="author/fullname|view/user">Tesdal</span>
  <span metal:use-macro="context/@@weeklyplan_macros/week_label"/>
</h1>
<form metal:use-macro="context/@@weeklyplan_macros/week_links_filter"></form>

<p>Use this view to follow your progress during the week and how it matches the plans. This should make it easy to notice if progress deviates from the plans. Tasks planned for the week should be listed below.</p>

<p metal:use-macro="context/@@weeklyplan_macros/weeklyplan_menu" />
    
    <fieldset>
        <legend>Tasks planned for 
        <span tal:define="author python:mtool.getMemberInfo(view.user)"
              tal:replace="author/fullname|view/user">Tesdal</span>
        week <span tal:replace="view/start/week">5</span>, 
        <span tal:replace="python:view.shortDate(view.start)">Feb 05</span>
        &mdash; <span tal:replace="python:view.shortDate(view.end)">Feb 09</span></legend>
<p>

    <table 
        class="listing" id="sortable" style="width :100%; clear: both; margin-bottom: 2em;"
        tal:repeat="dayplan view/personal_plan">
        <thead>  
            <tr>
                <th colspan="6" class="nosort">
                  <big tal:define="date python:view.shortDate(dayplan['date'])"
                       tal:content="string: ${dayplan/weekday} $date">Monday Feb 6th</big>
                </th>
            </tr>
            <tr>
                <th>Where</th>
                <th>Task</th>
                <th>State</th>
                <th>Due</th>
                <th>Priority</th>
                <th>Progress</th>
            </tr>
        </thead>
        <tbody>            
            <tr tal:repeat="task dayplan/tasks" 
                tal:attributes="class repeat/task/parity">
                <td>
                  <span tal:replace="task/info/getProjectTitle">ABM</span>,
                  <span tal:replace="task/info/getPhaseTitle">Implementation/configuration</span>
                </td>
                <td class="state-assigned"
                    tal:attributes="class string:state-${task/info/review_state}">
                    <a href="#" tal:attributes="href task/info/getURL"
                       tal:content="string:#${task/info/getId} ${task/info/pretty_title_or_id}">
                      #61 translate the new custom roles to norwegian
                    </a>
                </td>
                <td tal:content="structure task/info/@@workflowactions"
                    >assigned</td>
                <td class="overdue"
                    tal:attributes="class python:task['overdue'] and 'overdue'"
                    tal:content="dayplan/weekday"
                    >Monday</td>       
                <td class="priority-5"
                    tal:attributes="class string:priority-${task/info/getPriority}"
                    tal:content="task/priority"
                    >Normal</td>
                <td tal:content="structure task/progressbar"><a class="progressbar-small" href="#" title="0h worked, 1h remain"><span class="progressbar-done"></span><span class="progressbar-remaining"></span></a>
                </td>        
            </tr>
        </tbody>
        <tfooter>
            <tr>
                <th colspan="5" style="text-align: right">sum</th>
                <td><span tal:replace="dayplan/sum">4</span> hours</td>
            </tr>
        </tfooter>
    </table>
    
    <script type="text/javascript">
        WorkflowActions.subscribe(function(action) { action.element.up().previous().className = 'state-' + action.state; })
    </script>

    </fieldset>  
</div>
</body>
</html>
