<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<div metal:fill-slot="main"
       tal:define="results python:here.getTasks();
                 Batch python:modules['Products.CMFPlone'].Batch;
                 DateTime python:modules['DateTime'].DateTime;
                 b_size python:30;b_start python:0;b_start request/b_start | b_start;
                 desc_length site_properties/search_results_description_length;
                 desc_ellipsis site_properties/ellipsis;
                 searchterm request/SearchableText|nothing">

    <h1>Tasks</h1>

    <div tal:condition="not: results">
        <p><strong>No tasks were found.</strong></p>
    </div>

   
    <div tal:condition="results"
          tal:define="batch python:Batch(results, b_size, int(b_start), orphan=1);">

        <strong>
        <span i18n:translate="batch_x_items_matching_your_criteria"><span i18n:name="number" tal:content="python:len(results)">234</span> items matching your criteria.</span>
        </strong>

        <a href=""
            tal:define="here_url context/@@plone_context_state/object_url;"
            tal:attributes="href string:$here_url/search_rss?${request/QUERY_STRING}">
        <img i18n:attributes="title alt"
             tal:attributes="src string:$portal_url/rss.gif"
             src="rss.gif"
             alt="RSS Feed"
             title="RSS feed of these search results" />
        </a>

        <!-- Search results -->

        <dl>
        <tal:results repeat="result batch">
        <tal:entry define="url result/getURL;">
            <dt>
               <a href="#"
                tal:attributes="href url">
                <img tal:replace="structure python:path('here/linkOpaque.gif')"
                     tal:condition="python:not path('here/%s' % result.getIcon)" 
                     /></a><img tal:replace="structure python:path('here/%s' % result.getIcon)"
                     tal:condition="python:path('here/%s' % result.getIcon)"  
                     /></a>&nbsp;<a
                href="#" tal:attributes="href url"
                tal:content="python:result.Title or result.getId" />
               
                <span class="discreet">
                by <span tal:replace="result/Creator">responsible</span>,
                <span tal:replace="python:here.toPortalTime(result.ModificationDate)">Modification Date</span>
                </span>

            </dt>
            
            <dd class="discreet" tal:content="python:here.cropText(result.Description, desc_length, desc_ellipsis)"> Description </dd>

        </tal:entry>
        </tal:results>
        </dl>
         
        <!-- Navigation -->
        <div metal:use-macro="here/batch_macros/macros/navigation" />

    </div>
</div>


</html>

