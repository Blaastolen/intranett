(function(d){var b,c,a,e;b=function(f){d.extend(this,f);this.terms=this.cleanTerms(this.terms.length?this.terms:this.getSearchTerms())};b.prototype={highlight:function(g){if(!this.terms.length||!g.length){return}var f=this;d.each(this.terms,function(j,h){g.find("*:not(textarea)").andSelf().contents().each(function(){if(this.nodeType===3){f.highlightTermInNode(this,h)}})})},highlightTermInNode:function(k,l){var m=k.nodeValue,g=this,f,i,h,j;if(d(k).parent().hasClass(g.highlightClass)){return}f=function(n){return d('<span class="'+g.highlightClass+'">'+n+"</span>")};i=g.caseInsensitive;while(m&&(h=(i?m.toLowerCase():m).indexOf(l))>-1){d(k).before(document.createTextNode(m.substr(0,h))).before(f(m.substr(h,l.length))).before(document.createTextNode(m.substr(h+l.length)));j=k.previousSibling;d(k).remove();k=j;m=k.nodeValue}},queryStringValue:function(g,h){var f,i;if(g.indexOf("?")<0){return""}g=g.substr(g.indexOf("?")+1);while(g.indexOf("=")>=0){g=g.replace(/^\&*/,"");i=g.split("&",1)[0];g=g.substr(i.length);f=i.match(h);if(f){return decodeURIComponent(f[f.length-1].replace(/\+/g," "))}}return""},termsFromReferrer:function(){var g,f,h;g=d.fn.highlightSearchTerms._test_referrer!==null?d.fn.highlightSearchTerms._test_referrer:document.referrer;if(!g){return""}for(f=0;f<this.referrers.length;f+=1){h=this.referrers[f];if(g.match(h.address)){return this.queryStringValue(g,h.key)}}return""},cleanTerms:function(g){var f=this;return d.unique(d.map(g,function(h){h=d.trim(f.caseInsensitive?h.toLowerCase():h);return(!h||f.filterTerms.test(h))?null:h}))},getSearchTerms:function(){var g=[],f=d.fn.highlightSearchTerms._test_location!==null?d.fn.highlightSearchTerms._test_location:location.href;if(this.useReferrer){d.merge(g,this.termsFromReferrer().split(/\s+/))}if(this.useLocation){d.merge(g,this.queryStringValue(f,this.searchKey).split(/\s+/))}return g}};c=function(f){return(typeof f==="string")?new RegExp("^"+f+"=(.*)$","i"):f};a=function(f){return(typeof f==="string")?new RegExp("^https?://(www\\.)?"+f,"i"):f};d.fn.highlightSearchTerms=function(g){g=d.extend({},e,g);g=d.extend(g,{searchKey:c(g.searchKey),referrers:d.map(g.referrers,function(h){return{address:a(h.address),key:c(h.key)}})});if(g.includeOwnDomain){var f=d.fn.highlightSearchTerms._test_location!==null?d.fn.highlightSearchTerms._test_location:location.hostname;g.referrers.push({address:a(f.replace(/\./g,"\\.")),key:g.searchKey})}new b(g).highlight(this);return this};d.fn.highlightSearchTerms.referrers=[{address:"google\\.",key:"q"},{address:"search\\.yahoo\\.",key:"p"},{address:"search\\.msn\\.",key:"q"},{address:"search\\.live\\.",key:"query"},{address:"search\\.aol\\.",key:"userQuery"},{address:"ask\\.com",key:"q"},{address:"altavista\\.",key:"q"},{address:"feedster\\.",key:"q"}];e={terms:[],useLocation:true,searchKey:"(searchterm|SearchableText)",useReferrer:true,referrers:d.fn.highlightSearchTerms.referrers,includeOwnDomain:true,caseInsensitive:true,filterTerms:/(not|and|or)/i,highlightClass:"highlightedSearchTerm"};d.fn.highlightSearchTerms._test_location=null;d.fn.highlightSearchTerms._test_referrer=null;d.fn.highlightSearchTerms._highlighter=b}(jQuery));jQuery(function(a){a("#region-content,#content").highlightSearchTerms({includeOwnDomain:a("dl.searchResults").length===0})});