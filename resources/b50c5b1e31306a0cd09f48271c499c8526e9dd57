var common_content_filter="#content>*:not(div.configlet),dl.portalMessage.error,dl.portalMessage.info";jQuery.extend(jQuery.tools.overlay.conf,{fixed:false,speed:"fast",mask:{color:"#fff",opacity:0.4,loadSpeed:0,closeSpeed:0}});jQuery(function(c){if(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)<7){return}function a(f,e){var g=c(f),d=g.find("dl.portalMessage.error");if(d.length){g.children().replaceWith(d);return false}else{return e}}function b(d,f){var e=f.match(/<base href="(\S+?)"/i);if(e.length===2){return e[1]}return location}c('#portal-personaltools a[href$="/login"], #portal-personaltools a[href$="/login_form"], .discussion a[href$="/login"], .discussion a[href$="/login_form"]').prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:"form#login_form",noform:function(){if(location.href.search(/pwreset_finish$/)>=0){return"redirect"}else{return"reload"}},redirect:function(){var d=location.href;if(d.search(/pwreset_finish$/)>=0){return d.slice(0,d.length-14)+"logged_in"}else{return d}}});c("#siteaction-contact a").prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:'form[name="feedback_form"]',noform:function(d){return a(d,"close")}});c("form[name=reply]").prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:'form:has(input[name="discussion_reply:method"])',noform:function(d){return a(d,"redirect")},redirect:b});c("#contextSetDefaultPage, #folderChangeDefaultPage").prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:'form[name="default_page_form"]',noform:function(d){return a(d,"reload")},closeselector:"[name=form.button.Cancel]",width:"40%"});c("dl#plone-contentmenu-actions a#delete").prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:"#delete_confirmation",noform:function(d){return a(d,"redirect")},redirect:b,closeselector:"[name=form.button.Cancel]",width:"50%"});c("dl#plone-contentmenu-actions a#rename").prepOverlay({subtype:"ajax",filter:common_content_filter,closeselector:"[name=form.button.Cancel]",width:"40%"});c('#portal-personaltools a[href$="/@@register"]').prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:"form.kssattr-formname-register"});c("form[name=users_add], form[name=groups_add]").prepOverlay({subtype:"ajax",filter:common_content_filter,formselector:'form.kssattr-formname-new-user, form[name="groups"]',noform:function(d){return a(d,"redirect")},redirect:function(){return location.href}});c("#content-history a").prepOverlay({subtype:"ajax",filter:"h2, #content-history",urlmatch:"@@historyview",urlreplace:"@@contenthistorypopup"})});