[buildout]
extends = development.cfg
parts +=
    varnish-build
    varnish-config
    varnish

[instance]
http-address = 127.0.0.1:8081
http-force-connection-close = on

[varnish-build]
recipe = zc.recipe.cmmi
url = http://www.varnish-software.com/sites/default/files/varnish-2.1.4.tar.gz

[varnish-config]
recipe = collective.recipe.template
input = templates/varnish.vcl.in
output = ${buildout:parts-directory}/varnish-config/etc/varnish.vcl
backend-host = 127.0.0.1
backend-port = 8081

[varnish]
recipe = plone.recipe.varnish
daemon = ${buildout:parts-directory}/varnish-build/sbin/varnishd
config = ${buildout:parts-directory}/varnish-config/etc/varnish.vcl
bind = 0.0.0.0:8080
cache-size = 64M
mode = foreground
