<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<head>
    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border',1);
                             disable_column_one python:request.set('disable_plone.leftcolumn',1);
                             disable_column_two python:request.set('disable_plone.rightcolumn',1);" />
</head>

<body>

<metal:main fill-slot="content"
    tal:define="errors options/state/getErrors;">
    <tal:main-macro metal:define-macro="main"
                    tal:define="site_properties here/portal_properties/site_properties;
                                allowAnonymousViewAbout python:site_properties.getProperty('allowAnonymousViewAbout', True);
                                isAnon context/@@plone_portal_state/anonymous;
                                raiseUnauthorized python:(not isAnon or allowAnonymousViewAbout) or here.raiseUnauthorized();
                                url_unquote_plus python:modules['Products.PythonScripts.standard'].url_unquote_plus;
                                author python:(len(request.traverse_subpath) > 0 and url_unquote_plus(request.traverse_subpath[0])) or request.get('author', None);
                                mtool python:context.portal_membership;
                                portrait python: mtool.getPersonalPortrait(author, thumbnail=False);
                                portal_types context/portal_types;
                                authorinfo python: mtool.getMemberInfo(author);
                                portal_url context/@@plone_portal_state/navigation_root_url;
                                here_url context/@@plone_context_state/object_url;
                                member context/@@plone_portal_state/member;
                                portal context/@@plone_portal_state/portal;
                                email_from_address portal/email_from_address">

        <tal:noAuthor condition="not: authorinfo">
            <dl class="portalMessage error">
                <dt i18n:translate="">
                    Error
                </dt>
                <dd i18n:translate="text_no_user_by_name">
                    No user by that name.
                </dd>
            </dl>
            <div id="content">
                &nbsp;
            </div>
        </tal:noAuthor>

        <tal:haveAuthor condition="authorinfo"
            tal:define="isOwner python:member.getId()==author;
                        isAnon context/@@plone_portal_state/anonymous;">

            <div id="edit-bar" tal:condition="isOwner">
                <h5 class="hiddenStructure">Views</h5>
                <ul id="content-views"
                    class="contentViews">
                  <li class="selected">
                    <a href=""
                        tal:define="url_quote_plus python:modules['Products.PythonScripts.standard'].url_quote_plus;
                                    memberurl python:url_quote_plus(member.getId())"
                       tal:attributes="href string:${portal_url}/author/${memberurl}"
                       i18n:translate="label_view">View</a>
                  </li>
                  <li>
                    <a href=""
                       tal:attributes="href string:${portal_url}/@@personal-information"
                       i18n:translate="label_edit">Edit</a>
                  </li>
                </ul>
                <div class="contentActions">&nbsp;</div>
                 <!-- end simulated tabs -->
            </div>

            <div metal:use-macro="context/global_statusmessage/macros/portal_message">
                Portal status message
            </div>

            <div id="content">
                <span class="visualClear"><!-- --></span>
                <div id="row">
                    <div class="cell width-6 position-0">
                        <img src=""
                             alt=""
                             class="portraitPhoto image-left"
                             tal:attributes="src portrait/absolute_url" />

                        <ul class="visualClear" i18n:domain="intranett">
                            <li tal:condition="authorinfo/department">
                                <!-- Department -->
                                <b><span tal:omit-tag="" i18n:translate="label_department">Department</span>:</b>
                                <a href=""
                                     tal:attributes="href string:${context/absolute_url}/employee-listing?department=${authorinfo/department}"
                                     tal:content="authorinfo/department">Departent</a>
                            </li>
                            <li tal:condition="authorinfo/location">
                                <!-- Location  -->
                                <b><span tal:omit-tag="" i18n:translate="label_location">Location</span>:</b>
                                <span tal:replace="authorinfo/location">
                                    Some location
                                </span>
                            </li>
                            <li tal:condition="authorinfo/email">
                                <!-- E-mail  -->
                                <b><span tal:omit-tag="" i18n:translate="label_email">Email</span>:</b>
                                <a href="" title=""
                                   tal:attributes="href string:mailto:${authorinfo/email}"
                                   tal:content="authorinfo/email">
                                    joe@doe.com
                                </a>
                            </li>
                            <li tal:condition="authorinfo/phone">
                                <!-- Phone -->
                                <b><span tal:omit-tag="" i18n:translate="label_phone">Phone</span>:</b>
                                <span tal:content="authorinfo/phone"
                                      tal:omit-tag="">
                                    Phone
                                </span>
                            </li>
                            <li tal:condition="authorinfo/mobile">
                                <!-- Mobile phone -->
                                <b><span tal:omit-tag="" i18n:translate="label_mobile">Mobile phone</span>:</b>
                                <span tal:content="authorinfo/mobile"
                                      tal:omit-tag="">
                                    Mobile phone
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="cell width-10 position-6">
                        <h1 class="documentFirstHeading" tal:condition="authorinfo/fullname" tal:content="authorinfo/fullname">
                            Author name
                        </h1>

                        <h1 class="documentFirstHeading" tal:condition="not: authorinfo/fullname" tal:content="author">
                            Author ID
                        </h1>

                        <div class="documentDescription" tal:content="authorinfo/description">
                            Author description.
                        </div>

                        <p tal:condition="python:mtool.getHomeFolder(id=author)">
                        <a href="#" tal:attributes="href python:mtool.getHomeFolder(id=author).absolute_url()"
                           i18n:translate="label_author_internal_home_page">Author's home page in this site&hellip;</a>
                        </p>

                        <p tal:condition="python: not mtool.getHomeFolder(id=author) and authorinfo['home_page']">
                        <a href="#"
                           rel="nofollow"
                           tal:attributes="href authorinfo/home_page"
                           i18n:translate="label_author_external_home_page">Author's external home page&hellip;</a>
                        </p>

                        <tal:authorContent define="author_content python:context.portal_catalog.searchResults(Creator=author, sort_on='created', sort_order='reverse')[:10];"
                                           condition="author_content">

                            <h2 i18n:translate="heading_author_content">
                                Latest content created by this user
                            </h2>

                            <div metal:define-macro="user_content_listing">
                            <table class="vertical listing"
                                   summary="Lists content written by an author grouped by content type"
                                   i18n:attributes="summary summary_author_content_list;">
                                <tal:repeat repeat="item author_content">
                                    <tr>
                                        <th tal:define="toLocalizedTime nocall: context/@@plone/toLocalizedTime;"
                                            tal:content="python:toLocalizedTime(item.Date)"
                                            style="white-space: nowrap">
                                            Date
                                        </th>
                                        <td>
                                            <a href="" tal:attributes="href item/getURL"
                                               tal:content="item/pretty_title_or_id">title</a>
                                        </td>
                                    </tr>
                                </tal:repeat>
                            </table>
                            </div>

                            <p>
                            <a href=""
                               tal:attributes="href string:$here_url/search?Creator=${author}&amp;sort_on=created&amp;sort_order=reverse"
                               i18n:translate="go_to_search_author_content">
                                All content created by
                                <span i18n:name="user" tal:omit-tag="" tal:content="python:authorinfo['fullname'] or author"/>&hellip;
                            </a>
                            </p>

                        </tal:authorContent>

                    </div>
                </div>

            </div>

            </tal:haveAuthor>

    </tal:main-macro>

</metal:main>

</body>
</html>
