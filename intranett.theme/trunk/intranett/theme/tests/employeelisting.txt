Employee listing
----------------

Preparations:

    >>> self.loginAsPortalOwner()
    >>> from Products.CMFCore.utils import getToolByName
    >>> mtool = getToolByName(self.portal, 'portal_membership')
    >>> from Acquisition import aq_get
    >>> _doAddUser = aq_get(self.portal, 'acl_users')._doAddUser

Let's add some members to the site:

    >>> for i in range(1, 4):
    ...     mi = 'member-%s' % str(i)
    ...     _doAddUser(mi, 'secret', ['Member'], [])
    ...     mdata = mtool.getMemberById(mi)
    ...     fullname = 'Memb\xc3\xa5r %s' % str(i)
    ...     img = 'http://nohost/plone/portal_memberdata/thumbnails/%s' % mi
    ...     mdata.setMemberProperties(dict(fullname=fullname,
    ...                               department='Dept\xc3\xa5 1',
    ...                               thumbnail_url=img))

We have more than one department and an user without an image:

    >>> mdata = mtool.getMemberById('member-3')
    >>> mdata.setMemberProperties(dict(department='Dept\xc3\xa5 2'))
    >>> mdata.setMemberProperties(dict(thumbnail_url=''))

    >>> self.logout()

As a normal user we can view the listing:

    >>> browser = self.getBrowser()
    >>> browser.handleErrors = False
    >>> browser.open('http://nohost/plone/employee-listing')

    >>> browser.url.endswith('employee-listing')
    True
