Employee listing
----------------

Preparations:

    >>> from plone.app.testing import setRoles
    >>> from plone.app.testing import TEST_USER_ID
    >>> portal = layer['portal']
    >>> setRoles(portal, TEST_USER_ID, ['Manager'])

    >>> from Products.CMFCore.utils import getToolByName
    >>> portal = layer['portal']
    >>> mtool = getToolByName(portal, 'portal_membership')

Let's add some members to the site:

    >>> for i in range(1, 4):
    ...     mid = 'member-%d' % i
    ...     mtool.addMember(mid, 'secret', ['Member'], [])
    ...     member = mtool.getMemberById(mid)
    ...     email = 'ff%d@slaterock.com' % i
    ...     fullname='Memb\xc3\xa5r %d' % i
    ...     member.setMemberProperties(dict(fullname=fullname,
    ...                                    email=email,
    ...                                    position='Crane Operator',
    ...                                    department='Dept\xc3\xa5 1'))

Set a user to a different department:

    >>> member = mtool.getMemberById('member-3')
    >>> member.setMemberProperties(dict(department='Dept\xc3\xa5 2'))

    >>> from plone.app.testing import logout
    >>> logout()

As a normal user we can view the listing:

    >>> from intranett.policy.tests.base import get_browser
    >>> browser = get_browser(layer)
    >>> browser.handleErrors = False

    >>> browser.open('http://nohost/plone/employee-listing')
    >>> browser.url.endswith('employee-listing')
    True
